# -*- coding: utf-8 -*-
"""
Created on Mon Nov 13 14:34:06 2017

@author: tigan_5ytncvu
"""

import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

volume = [319.489803,
          320.354778,
          321.219948,
          322.084727,
          322.949702,
          323.814676,
          324.679651,
          325.544625,
          325.316554,
          327.294576,
        318.626164,
          317.759844,
          316.89489,
          316.029907,
          315.164932,
          314.299856,
          313.434983,
          312.570007,
          311.705034,
          310.840058,
          309.975085,
          309.11011,
          308.245136,
          307.380101,
          306.515187,
          305.656912,
          304.785238,
          303.926263,
          303.055294,
          302.190314,
         301.325339,
          300.460365,
          299.59539,
          298.780416,
          297.865441,
          297.010423,
          296.135492,
          295.270519,
          294.405544,
          293.540568,
          292.675595, 
    275.376104,
        266.725025,
        284.02585,
        288.35063,
        279.70097,
        278.830146,
        280.565949,
        281.430926,
        280.998439,
        280.133464,
        277.971028,
        277.106053,
        276.227415,
        276.511131,
        273.64613,
        309.650779
          
        ]

energy=[2.44356585,
        2.44342574,
        2.44328369,
        2.44313974,
        2.44299391,
        2.44284633,
        2.4426960,
        2.44255680,
        2.44258571,
        2.44223984,
    2.44370536,
        2.443841,
        2.443976,
        2.44410968,
        2.44424261,
        2.44437435,
        2.44450454,
        2.44463295,
        2.44475954,
        2.44488426,
        2.445007,
        2.44512775,
        2.44524673,
        2.44536396,
        2.44547902,
        2.44559130,
        2.4457056,
        2.445807,
        2.44591084,
        2.44601230,
    2.446112,
        2.44620858,
        2.44630354,
        2.44639621,
        2.44648622,
        2.44657207,
        2.44665604,
        2.44673443,
        2.44680785,
        2.44687681,
        2.44694193,
    2.447332,
    2.446822,
    2.447365,
    2.44720813,
    2.44740922,
    2.44740236,
    2.44741130,
    2.44740807,
    2.44741038,
    2.44741088,
    2.44739110,
    2.447385,
    2.447355,
    2.44730375,
    2.447271,
    2.445052
        ]
volume2=[200.583,
         206.3137,
         207.74,
         209.179,
         210.61189,
         212.045,
         213.477,
         214.193,
         214.91,
         215.626,
         216.3428,
         217.059192,
         217.775559,
         218.491926,
         219.208293,
         219.924660,
         220.641027,
         221.357394,
         214.910091,
        227.37,
        233.97
         
        ]

energy2=[0.18793,
         0.12325,
         0.10794,
         0.092968,
         0.078329,
         0.06402,
         0.05004693,
         0.04309,
         0.03629,
         0.02957021,
         0.02292785,
         0.016364,
         0.00987821,
         0.00354620,
         -0.00286101,
         -0.00977533,
         -0.01520922,
         -0.02139573,
         0.03643311,
         -0.0696,
         -0.116912
        ]

def func (x,a,b,c):
    #return -a*np.exp(-b*x) + c
    return a + b*x + c*x**2

popt, pcov = curve_fit(func, volume, energy)
print('popt')
print(popt)
print('pcov')
print(pcov)

fig = plt.figure()
ax = fig.add_subplot(111)
ax.set_title('Enerny-Volume curve variable c/a ratio')
ax.set_xlabel('Volume (Ry^3)')
ax.set_ylabel('Energy (Ry)')
ax.scatter(volume, energy)
y = func(np.asarray(volume), *popt)
ax.plot(volume, y, 'r-', label='poly fit')
fig2 = plt.figure()
ax2 = fig2.add_subplot(111)
ax2.set_title('Energy-Volume curve Pair Potential c/a ratio')
ax2.set_xlabel('Volume (Ry^3)')
ax2.set_ylabel('Energy (Ry)')
ax2.scatter(volume2, energy2)
plt.legend()
plt.show()





